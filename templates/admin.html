
<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Admin - Portfolio</title>
    <style>
      body{font-family:system-ui, sans-serif;padding:24px;max-width:1200px;margin:0 auto}
      .header{display:flex;justify-content:space-between;align-items:center;margin-bottom:32px}
      .alert{background:#d4edda;color:#155724;padding:12px;border-radius:6px;margin-bottom:16px;border:1px solid #c3e6cb}
      .alert.error{background:#f8d7da;color:#721c24;border-color:#f5c6cb}
      form{display:flex;flex-direction:column;gap:12px;max-width:600px;margin-bottom:40px}
      input,textarea,select{padding:12px;border:1px solid #ddd;border-radius:6px;font-family:inherit;font-size:inherit}
      button{background:#2196F3;color:#fff;padding:12px 20px;border:none;border-radius:6px;cursor:pointer;font-size:inherit}
      button:hover{background:#0b7dda}
      button.delete{background:#dc3545}
      button.delete:hover{background:#c82333}
      img.thumb{max-width:120px;border-radius:6px;height:80px;object-fit:cover}
      table{width:100%;border-collapse:collapse;margin-top:20px;background:#fff;border-radius:8px;overflow:hidden;box-shadow:0 2px 8px rgba(0,0,0,.1)}
      th{background:#f8f9fa;padding:16px;text-align:left;font-weight:600;border-bottom:1px solid #dee2e6}
      td{padding:16px;border-bottom:1px solid #dee2e6}
      tr:last-child td{border-bottom:none}
      .actions{display:flex;gap:8px}
      .section{margin-bottom:40px;padding-bottom:32px;border-bottom:1px solid #eee}
    </style>
  </head>
  <body>
    <div class="header">
      <h1>Portfolio Admin</h1>
      <div>
        <a href="/">View Portfolio</a> | 
        <a href="/logout">Logout</a>
      </div>
    </div>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="alert{% if category == 'error' %} error{% endif %}">{{ message }}</div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <div class="section">
      <h2>Upload New Work</h2>
      <form method="post" action="/admin/upload" enctype="multipart/form-data">
        <input type="text" name="title" placeholder="Title" required>
        <textarea name="description" placeholder="Description" rows="3"></textarea>
        <input type="file" name="file" accept="image/*" required>
        <button type="submit">Upload Image</button>
      </form>
    </div>

    <div class="section">
      <h2>Existing Works ({{ works|length }})</h2>
      {% if works %}
      <table>
        <thead>
          <tr>
            <th>Preview</th>
            <th>Details</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for work in works %}
          <tr>
            <td><img src="/static/uploads/{{ work.filename }}" class="thumb" alt="{{ work.title }}"></td>
            <td>
              <strong>{{ work.title }}</strong><br>
              {{ work.description or 'No description' }}<br>
              <small>Added: {{ work.created_at[:16] }}</small>
            </td>
            <td>
              <div class="actions">
                <form method="post" action="/admin/delete" onsubmit="return confirm('Delete this work?')">
                  <input type="hidden" name="id" value="{{ work.id }}">
                  <button type="submit" class="delete">Delete</button>
                </form>
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      {% else %}
      <p>No works yet. Upload your first image above.</p>
      {% endif %}
    </div>
  </body>
</html>
